"use strict";(self["webpackChunknissy_tech"]=self["webpackChunknissy_tech"]||[]).push([[443],{2910:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var r=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"introduction"},[e("h1",{staticClass:"page-title"},[t._v("グリグリを使った3Dヒートマップ")]),e("h2",{staticClass:"introduction-title"},[t._v("技術紹介")]),e("div",{staticClass:"introduction-top-wrapper"},[e("div",{staticClass:"introduction-top-inner"},[t.isMounted?e("model-viewer",{staticClass:"model-viewer",attrs:{id:"heat-map-3d-demo",src:"assets/models/cube.glb","camera-controls":""}}):t._e(),e("p",{staticClass:"introduction-top-text",attrs:{id:"search-text",hidden:""}},[t._v("計測中..")]),e("div",{staticClass:"introduction-btn-wrapper"},[e("button",{staticClass:"introduction-btn",attrs:{id:"start-btn"},on:{click:function(e){return t.startMeasuremunt()}}},[t._v("計測を開始")]),e("button",{staticClass:"introduction-btn",attrs:{id:"stop-btn",disabled:""},on:{click:function(e){return t.stopMeasuremunt()}}},[t._v("計測を終了")])])],1),t._m(0),e("div",{staticClass:"introduction-score-wrapper"},[e("h3",[t._v("ユーザーが閲覧した割合")]),e("ul",{staticClass:"introduction-score-list"},t._l(t.scores,(function(a){return e("li",{key:a.key,class:`introduction-score-itme-${a.key}`},[e("style",{tag:"component"},[t._v(" .introduction-score-itme-"+t._s(a.key)+"{ color: rgb("+t._s(a.color[0])+","+t._s(a.color[1])+","+t._s(a.color[2])+"); } ")]),t._v(" "+t._s(a.name)+"："+t._s(a.value)+" % ")],1)})),0),t._m(1)])])])])},s=[function(){var t=this,e=t._self._c;return e("div",[e("img",{attrs:{src:"assets/images/color-bar.png",alt:"color-bar",width:"30",height:"400"}})])},function(){var t=this,e=t._self._c;return e("div",[e("h3",[t._v("操作説明")]),e("ul",{staticClass:"introduction-detail-list"},[e("li",[t._v(" 計測を開始ボタンを押す ")]),e("li",[t._v(" 好きなだけキューブをグリグリする ")]),e("li",[t._v(" 計測を終了ボタンを押す ")]),e("li",[t._v(" キューブの面に、その面を見た時間の長さに応じたヒートマップが生成される ")])])])}],o={name:"HeatMap3d",data(){return{isMounted:!1,timer:null,deltaTime:100,thetaArray:[],phiArray:[],scores:[{key:"front",name:"正面",value:0,color:[0,0,0]},{key:"back",name:"裏面",value:0,color:[0,0,0]},{key:"right",name:"右面",value:0,color:[0,0,0]},{key:"left",name:"左面",value:0,color:[0,0,0]},{key:"up",name:"上面",value:0,color:[0,0,0]},{key:"down",name:"下面",value:0,color:[0,0,0]}]}},methods:{startMeasuremunt(){document.getElementById("start-btn").disabled=!0,document.getElementById("stop-btn").disabled=!1,document.getElementById("search-text").hidden=!1,this.resetMaterialColor(),this.timer=window.setInterval((()=>{this.getCameraLocation()}),100)},stopMeasuremunt(){document.getElementById("start-btn").disabled=!1,document.getElementById("stop-btn").disabled=!0,document.getElementById("search-text").hidden=!0,clearInterval(this.timer),this.time=null,this.scores[0].value=this.calculateFrontScore(),this.scores[1].value=this.calculateBackScore(),this.scores[2].value=this.calculateRightScore(),this.scores[3].value=this.calculateLeftScore(),[this.scores[4].value,this.scores[5].value]=this.calculateUpDownScore(),this.scoreToColor(),this.setMaterialColor(),this.NormalizeScore(),this.thetaArray=[],this.phiArray=[]},getCameraLocation(){const t=document.querySelector("model-viewer#heat-map-3d-demo"),e=t.getCameraOrbit().theta,a=t.getCameraOrbit().phi,r=this.convertTheta(e),s=this.convertPhi(a);this.thetaArray.push(r),this.phiArray.push(s)},convertTheta(t){let e=2-2*(t/Math.PI/2-Math.floor(t/Math.PI/2));return e>1&&(e-=2),e=Math.floor(100*e)/100,e},convertPhi(t){let e=2*(t/Math.PI/2-Math.floor(t/Math.PI/2));return e>1&&(e-=2),e=Math.floor(100*e)/100,e},calculateFrontScore(){let t=0;for(let e=0;e<this.thetaArray.length;e++){let a=0,r=0;Math.abs(this.thetaArray[e])<.5&&(a=Math.cos(this.thetaArray[e]*Math.PI)),Math.abs(this.phiArray[e])>0&&Math.abs(this.phiArray[e])<1&&(r=Math.sin(this.phiArray[e]*Math.PI)),t+=a*r}return t/=this.thetaArray.length,t},calculateBackScore(){let t=0;for(let e=0;e<this.thetaArray.length;e++){let a=0,r=0;Math.abs(this.thetaArray[e])>.5&&(a=-Math.cos(this.thetaArray[e]*Math.PI)),Math.abs(this.phiArray[e])>0&&Math.abs(this.phiArray[e])<1&&(r=Math.sin(this.phiArray[e]*Math.PI)),t+=a*r}return t/=this.thetaArray.length,t},calculateRightScore(){let t=0;for(let e=0;e<this.thetaArray.length;e++){let a=0,r=0;this.thetaArray[e]>0&&(a=Math.sin(this.thetaArray[e]*Math.PI)),Math.abs(this.phiArray[e])>0&&Math.abs(this.phiArray[e])<1&&(r=Math.sin(this.phiArray[e]*Math.PI)),t+=a*r}return t/=this.thetaArray.length,t},calculateLeftScore(){let t=0;for(let e=0;e<this.thetaArray.length;e++){let a=0,r=0;this.thetaArray[e]<0&&(a=-Math.sin(this.thetaArray[e]*Math.PI)),Math.abs(this.phiArray[e])>0&&Math.abs(this.phiArray[e])<1&&(r=Math.sin(this.phiArray[e]*Math.PI)),t+=a*r}return t/=this.thetaArray.length,t},calculateUpDownScore(){let t=0,e=0;for(let a=0;a<this.phiArray.length;a++)Math.abs(this.phiArray[a])<.5?t+=Math.cos(this.phiArray[a]*Math.PI):e-=Math.cos(this.phiArray[a]*Math.PI);return t/=this.phiArray.length,e/=this.phiArray.length,[t,e]},scoreToColor(){const t=Math.max(this.scores[0].value,this.scores[1].value,this.scores[2].value,this.scores[3].value,this.scores[4].value,this.scores[5].value);for(let e=0;e<this.scores.length;e++){const a=this.scores[e].value/t;let r=0,s=0,o=0;a>=.5&&(r=255*(2*a-1)),a>=.25&&a<=.5?s=510*a:a>.5&&a<=.75&&(s=255*(-2*a+2)),a<=.5&&(o=255*(-2*a+1)),this.scores[e].color=[Math.floor(r),Math.floor(s),Math.floor(o)]}},setMaterialColor(){const t=document.querySelector("model-viewer#heat-map-3d-demo");for(let e=0;e<t.model.materials.length;e++){const a=t.model.materials[e];a.pbrMetallicRoughness.setBaseColorFactor([this.scores[e].color[0]/255,this.scores[e].color[1]/255,this.scores[e].color[2]/255])}},resetMaterialColor(){const t=document.querySelector("model-viewer#heat-map-3d-demo");for(let e=0;e<t.model.materials.length;e++){const a=t.model.materials[e];a.pbrMetallicRoughness.setBaseColorFactor([.5,.5,.5])}},NormalizeScore(){let t=0;for(let e=0;e<this.scores.length;e++)t+=this.scores[e].value;for(let e=0;e<this.scores.length;e++)this.scores[e].value=Math.floor(this.scores[e].value/t*100)}},mounted(){this.isMounted=!0,this.loadComponent()},computed:{loadComponent(){return()=>a.e(25).then(a.bind(a,5025))}}},i=o,h=a(1001),l=(0,h.Z)(i,r,s,!1,null,"65affdfa",null),c=l.exports}}]);
//# sourceMappingURL=about.b649c34c.js.map